%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Maximum principles for the linearized operator and uniqueness of the saddle-shaped solution}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{Sec:MaximumPrinciple}

In this section we show that the linearized operator $L_K  -f'(u)$ satisfies the maximum principle in $\ocal$. This result combined with the asymptotic result of Theorem~\ref{Th:AsymptoticBehaviourSaddleSolution} yields the uniqueness of the saddle-shaped solution.

The maximum principle we establish is the following.

\begin{proposition}
	\label{Prop:MaximumPrincipleInO}
	Let $m\geq 1$, $\gamma \in (0,1)$, $\alpha > 2\gamma$ and let $v\in C^\alpha_{\mathrm{loc}}(\R^{2m})\cap L^\infty(\R^{2m})$ be a doubly radial function. Let $\Omega \subset \ocal$ a domain (not necessarily bounded) and let $L_K  \in \lcal_\star$. Assume that $v$ satisfies
	$$
	\beqc{\PDEsystem}
	L_K v - f'(u)v - c(x)v &\leq & 0 &\textrm{ in } \Omega\,,\\
	v &\leq & 0 &\textrm{ in } \ocal \setminus \Omega\,,\\
	- v(x^\star) & = & v(x) &\textrm{ in } \R^{2m},\\
	\ds \limsup_{x\in \Omega, \ |x|\to \infty} v(x) &\leq & 0\,,
	\eeqc
	$$
	with $c\leq 0$ in $\Omega$.
	Then, $v \leq 0$ in $\Omega$.
\end{proposition}

In order to prove this result we need a maximum principle in narrow domains, stated next.

\begin{proposition}
	\label{Prop:MaximumPrincipleNarrowDomainsOdd}
	Let $m\geq 1$, $\gamma \in (0,1)$, $\alpha > 2\gamma$ and let $v\in C^\alpha_{\mathrm{loc}}(\R^{2m})\cap L^\infty(\R^{2m})$ be a doubly radial function. Let $\varepsilon>0$ and let
	$$
	H \subset \{(x',x'')\in \R^m\times\R^m \ : \ |x''|<|x'|<|x''|+ \varepsilon\} \subset \ocal
	$$ 
	be a domain (not necessarily bounded). Let $L_K  \in \lcal_\star$ and assume that $v$ satisfies
	\begin{equation}
	\label{Eq:AssumptionsMaxPNarrow}
	\beqc{\PDEsystem}
	L_K v + c(x)v&\leq & 0 &\textrm{ in } H\,,\\
	v &\leq & 0 &\textrm{ in } \ocal \setminus H\,,\\
	- v(x^\star) & = & v(x) &\textrm{ in } \R^{2m},\\
	\ds \limsup_{x\in H, \ |x|\to \infty} v(x) &\leq & 0\,.
	\eeqc
	\end{equation}
	Under these assumptions there exists $\overline{\varepsilon}>0$ depending only on $\lambda, m, \s$ and $||c_-||_{L^\infty}$ such that, if $\varepsilon<\overline{\varepsilon}$, then $v \leq 0$ in $H$.
\end{proposition}

\begin{proof}
	Assume, by contradiction, that
	$$
	M := \sup_H v > 0\,.
	$$
	Under the assumptions \eqref{Eq:AssumptionsMaxPNarrow}, $M$ must be attained at an interior point $x_0 \in H$, that we can assume without loss of generality that is of the form $x_0 = (|x_0'|e,|x_0''|e)$, with $e=(1,0,...,0)\in\R^m$. Then,
	\begin{equation}
	\label{Eq:InequalitiesMaxPNarrowProof}
	0 \geq L_K  v(x_0) + c(x_0)v(x_0) \geq L_K  v(x_0) - \norm{c_-}_{L^\infty(H)}M\,.
	\end{equation} 
	Now, we compute $L_K  v(x_0)$. Since $v$ is doubly radial and odd with respect to the Simons cone, we can use the expression \eqref{Eq:OperatorOddF} to write
	\begin{align*}
	L_K v(x_0) &= \int_{\ocal} \big (M - v(y) \big) \big (\overline{K}(x_0,y) -\overline{K}(x_0,y^\star)\big) \d y + 2M\int_{\ocal} \overline{K}(x_0,y^\star)\d y\\
    &\geq2M \int_{\ocal} \overline{K}(x_0,y^\star)\d y,
	\end{align*}
    where the inequality follows from being $M$ the supremum of $v$ in $\ocal$ and the kernel inequality \eqref{Eq:KernelInequality}. Combining this last inequality with \eqref{Eq:InequalitiesMaxPNarrowProof}, we obtain
	$$
	0 \geq L_K  v(x_0) + c(x_0)v(x_0)  \geq M \left\{ 2 \int_{\ocal} \overline{K}(x_0,y^\star)\d y - \norm{c_-}_{L^\infty(H)}
	\right\}\,.
	$$
	
	Finally, if we use the lower bound of the integral term from Lemma~2.3. in \cite{FelipeSanz-Perela:IntegroDifferentialI} and the fact that $\dist(x_0,\ccal) \leq \varepsilon/\sqrt{2}$, we get
	\begin{align*}
	0 &\geq M \left\{ 2 \int_{\ocal} \overline{K}(x_0,y^\star)\d y - \norm{c_-}_{L^\infty(H)}
	\right\} \geq M \left(\frac{1}{C}\dist(x_0,\ccal)^{-2\s}-\norm{c_-}_{L^\infty(H)}\right) \\ &\geq M \left(\frac{1}{C}\varepsilon^{-2\s}-\norm{c_-}_{L^\infty(H)}\right).
	\end{align*}
	Therefore, for $\varepsilon$ small enough, we arrive at a contradiction that comes from assuming that the supremum is positive.
\end{proof}

Once this maximum principle in narrow domains is available, we can now proceed with the proof of Proposition~\ref{Prop:MaximumPrincipleInO}.

\begin{proof}[Proof of Proposition~\ref{Prop:MaximumPrincipleInO}]
    


	For the sake of simplicity, we will denote 
	$$
	\mathscr{L} w := L_K w - f'(u)w - cw\,.
	$$
	The crucial point in this proof is the fact that $u$ is a positive supersolution of the operator $\mathscr{L}$. Indeed, by \eqref{Eq:PropertyConcavityf} we get
	\begin{equation}
	\label{Eq:uSupersolLinearized}
	\mathscr{L} u = L_K u - f'(u)u - cu \geq f(u) - f'(u)u > 0 \quad \textrm{ in } \Omega \subset \ocal\,,
	\end{equation}
	where in the first inequality we have used that $u>0$ in $\ocal$ and that $c\leq 0$.
	
	Let $\varepsilon > 0$ be such that the maximum principle of Proposition~\ref{Prop:MaximumPrincipleNarrowDomainsOdd} is valid and define the following sets:
	$$
	\Omega_\varepsilon := \Omega \cap \{|x'| > |x''| + \varepsilon\}\quad \textrm{ and } \quad 
	\ncal_\varepsilon := \Omega \cap \{|x''| < |x'| < |x''| + \varepsilon\}\,.
	$$
	
	
    
    By contradiction, assume that there exists $x_0\in \Omega$ such that $v(x_0)> 0$.
	Set $w := v - \tau u$. By the asymptotic result, we have 
	\begin{equation}
		\label{Eq:u>delta}
		u \geq \delta > 0 \quad \textrm{ in } \overline{\Omega}_\varepsilon\,,
	\end{equation}
	for some $\delta >0$ (see Remark~\ref{Remark:u>delta}). Therefore,  $w < 0$ in $\overline{\Omega}_\varepsilon$ if $\tau$ is big enough,. Moreover, since $v\leq 0$ in $\ocal\setminus\Omega$, we have 
	$$
	w \leq 0 \quad \textrm{ in } \ocal \setminus \ncal_\varepsilon\,.
	$$
	Furthermore, we also have
	$$
	\limsup_{x\in \ncal_\varepsilon, \ |x|\to \infty} w(x) \leq 0
	$$
	and, by \eqref{Eq:uSupersolLinearized},
	$$
	\mathscr{L} w = \mathscr{L} v - \tau \mathscr{L} u \leq 0 \textrm{ in } \ncal_\varepsilon\,.
	$$
	Thus, since $w$ is odd with respect to $\ccal$, we can apply Proposition~\ref{Prop:MaximumPrincipleNarrowDomainsOdd} with $H = \ncal_\varepsilon$ to deduce that
	$$
	w \leq 0 \quad \textrm{ in } \Omega\,,
	$$
	if $\tau$ is big enough.
	
	Now, define 
	$$
	\underline{\tau}:= \inf \setcond{\tau > 0}{v - \tau u \leq 0 \ \textrm{ in } \Omega}.
	$$
	By the previous reasoning, $\underline{\tau}$ is well defined. Clearly, $v - \underline{\tau} u \leq 0 $ in $\Omega$. In addition, since $v(x_0)>0$, we have $-\underline{\tau} u(x_0) < v(x_0) - \underline{\tau} u (x_0) \leq 0$ and therefore, since $u(x_0)>0$, we deduce that  $\underline{\tau} > 0$.
	
	We claim that $v - \underline{\tau} u \not \equiv 0$. Indeed, if $v - \underline{\tau} u \equiv 0$ then $v = \underline{\tau} u$ and thus, since $\underline{\tau} > 0$, we get 
	$$
	0 \geq \mathscr{L} v(x_0) = \underline{\tau} \mathscr{L} u(x_0) > 0\,, 
	$$
	which is a contradiction.
	
	Then, since $v - \underline{\tau} u \not \equiv 0$, the strong maximum principle (Proposition~\ref{Prop:StrongMaximumPrincipleForOddFunctions}) yields
	$$
	v - \underline{\tau} u < 0 \quad \textrm{ in }\Omega\,.
	$$
	Therefore, by continuity, the assumption on $v$ at infinity and \eqref{Eq:u>delta}, there exists $0 < \eta <\underline{\tau}$ such that 
	$$
	\tilde{w} := v - (\underline{\tau} - \eta) u < 0 \quad \textrm{ in }\overline{\Omega}_\varepsilon\,.
	$$
	Using again the maximum principle in narrow domains with $\tilde{w}$ in $\ncal_\varepsilon$, we deduce that 
	$$
	v - (\underline{\tau} - \eta) u \leq 0 \quad \textrm{ in }\Omega\,,
	$$
	and this contradicts the definition of $\underline{\tau}$. Hence, $v\leq 0$ in $\Omega$.
\end{proof}



With these ingredients available, we can finally establish the uniqueness of the saddle-shaped solution.



\begin{proof}[Proof of Theorem~\ref{Th:Uniqueness}]
	Let $u_1$ and $u_2$ be two saddle-shaped solutions. Define $v := u_1 - u_2$ which is a doubly radial function that is odd with respect to $\ccal$. Then,
	$$
	L_K v = f(u_1) - f(u_2) \leq f'(u_2) (u_1 - u_2) = f'(u_2) v \quad \textrm{ in } \ocal\,,
	$$
	since $f$ is concave in $(0,1)$. Moreover, by the asymptotic result (see Theorem~\ref{Thm:AsymptoticBehaviourSaddleSolution}), we have
	$$
	\limsup_{x\in \ocal, \ |x|\to \infty} v(x) = 0\,.
	$$
	Then, by the maximum principle in $\ocal$ for the linearized operator $L_K  - f'(u_2)$ (see Proposition~\ref{Prop:MaximumPrincipleInO}), we are lead to $v \leq 0$ in $\ocal$, which means $u_1 \leq u_2$ in $\ocal$. Repeating the  argument with $-v = u_2 - u_1$ we deduce $u_1 \geq u_2$ in $\ocal$. Therefore, $u_1 = u_2$ in $\R^{2m}$.
\end{proof}


